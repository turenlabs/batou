package languages

import (
	"github.com/turenio/gtss/internal/rules"
	"github.com/turenio/gtss/internal/taint"
)

func (c *GoCatalog) Sinks() []taint.SinkDef {
	return []taint.SinkDef{
		// --- SQL Injection (CWE-89) ---
		{
			ID:            "go.database.sql.query",
			Category:      taint.SnkSQLQuery,
			Language:      rules.LangGo,
			Pattern:       `\.Query\(`,
			ObjectType:    "*sql.DB",
			MethodName:    "Query",
			DangerousArgs: []int{0},
			Severity:      rules.Critical,
			Description:   "SQL query with potentially tainted input",
			CWEID:         "CWE-89",
			OWASPCategory: "A03:2021-Injection",
		},
		{
			ID:            "go.database.sql.exec",
			Category:      taint.SnkSQLQuery,
			Language:      rules.LangGo,
			Pattern:       `\.Exec\(`,
			ObjectType:    "*sql.DB",
			MethodName:    "Exec",
			DangerousArgs: []int{0},
			Severity:      rules.Critical,
			Description:   "SQL exec with potentially tainted input",
			CWEID:         "CWE-89",
			OWASPCategory: "A03:2021-Injection",
		},
		{
			ID:            "go.database.sql.queryrow",
			Category:      taint.SnkSQLQuery,
			Language:      rules.LangGo,
			Pattern:       `\.QueryRow\(`,
			ObjectType:    "*sql.DB",
			MethodName:    "QueryRow",
			DangerousArgs: []int{0},
			Severity:      rules.Critical,
			Description:   "SQL query row with potentially tainted input",
			CWEID:         "CWE-89",
			OWASPCategory: "A03:2021-Injection",
		},
		{
			ID:            "go.database.sql.prepare",
			Category:      taint.SnkSQLQuery,
			Language:      rules.LangGo,
			Pattern:       `\.Prepare\(`,
			ObjectType:    "*sql.DB",
			MethodName:    "Prepare",
			DangerousArgs: []int{0},
			Severity:      rules.High,
			Description:   "SQL prepare with potentially tainted query string",
			CWEID:         "CWE-89",
			OWASPCategory: "A03:2021-Injection",
		},

		// --- Command Injection (CWE-78) ---
		{
			ID:            "go.os.exec.command",
			Category:      taint.SnkCommand,
			Language:      rules.LangGo,
			Pattern:       `exec\.Command\(`,
			ObjectType:    "",
			MethodName:    "Command",
			DangerousArgs: []int{0, 1, 2},
			Severity:      rules.Critical,
			Description:   "OS command execution with potentially tainted input",
			CWEID:         "CWE-78",
			OWASPCategory: "A03:2021-Injection",
		},
		{
			ID:            "go.os.exec.commandcontext",
			Category:      taint.SnkCommand,
			Language:      rules.LangGo,
			Pattern:       `exec\.CommandContext\(`,
			ObjectType:    "",
			MethodName:    "CommandContext",
			DangerousArgs: []int{1, 2, 3},
			Severity:      rules.Critical,
			Description:   "OS command execution with context and potentially tainted input",
			CWEID:         "CWE-78",
			OWASPCategory: "A03:2021-Injection",
		},

		// --- Path Traversal / File Write (CWE-22) ---
		{
			ID:            "go.os.open",
			Category:      taint.SnkFileWrite,
			Language:      rules.LangGo,
			Pattern:       `os\.Open\(`,
			ObjectType:    "",
			MethodName:    "Open",
			DangerousArgs: []int{0},
			Severity:      rules.High,
			Description:   "File open with potentially tainted path",
			CWEID:         "CWE-22",
			OWASPCategory: "A01:2021-Broken Access Control",
		},
		{
			ID:            "go.os.create",
			Category:      taint.SnkFileWrite,
			Language:      rules.LangGo,
			Pattern:       `os\.Create\(`,
			ObjectType:    "",
			MethodName:    "Create",
			DangerousArgs: []int{0},
			Severity:      rules.High,
			Description:   "File create with potentially tainted path",
			CWEID:         "CWE-22",
			OWASPCategory: "A01:2021-Broken Access Control",
		},
		{
			ID:            "go.os.writefile",
			Category:      taint.SnkFileWrite,
			Language:      rules.LangGo,
			Pattern:       `os\.WriteFile\(`,
			ObjectType:    "",
			MethodName:    "WriteFile",
			DangerousArgs: []int{0},
			Severity:      rules.High,
			Description:   "File write with potentially tainted path",
			CWEID:         "CWE-22",
			OWASPCategory: "A01:2021-Broken Access Control",
		},
		{
			ID:            "go.os.remove",
			Category:      taint.SnkFileWrite,
			Language:      rules.LangGo,
			Pattern:       `os\.Remove\(`,
			ObjectType:    "",
			MethodName:    "Remove",
			DangerousArgs: []int{0},
			Severity:      rules.High,
			Description:   "File removal with potentially tainted path",
			CWEID:         "CWE-22",
			OWASPCategory: "A01:2021-Broken Access Control",
		},
		{
			ID:            "go.filepath.join",
			Category:      taint.SnkFileWrite,
			Language:      rules.LangGo,
			Pattern:       `filepath\.Join\(`,
			ObjectType:    "",
			MethodName:    "Join",
			DangerousArgs: []int{1},
			Severity:      rules.Medium,
			Description:   "File path construction with potentially tainted component",
			CWEID:         "CWE-22",
			OWASPCategory: "A01:2021-Broken Access Control",
		},

		// --- Template Path Traversal (CWE-22) ---
		{
			ID:            "go.template.parsefiles",
			Category:      taint.SnkFileWrite,
			Language:      rules.LangGo,
			Pattern:       `template\.ParseFiles\(`,
			ObjectType:    "",
			MethodName:    "ParseFiles",
			DangerousArgs: []int{0},
			Severity:      rules.High,
			Description:   "Template parsed from file with potentially tainted path (arbitrary file read)",
			CWEID:         "CWE-22",
			OWASPCategory: "A01:2021-Broken Access Control",
		},

		// --- Open Redirect (CWE-601) ---
		{
			ID:            "go.http.redirect",
			Category:      taint.SnkRedirect,
			Language:      rules.LangGo,
			Pattern:       `http\.Redirect\(`,
			ObjectType:    "",
			MethodName:    "Redirect",
			DangerousArgs: []int{2},
			Severity:      rules.High,
			Description:   "HTTP redirect with potentially tainted URL",
			CWEID:         "CWE-601",
			OWASPCategory: "A01:2021-Broken Access Control",
		},

		// --- XSS / HTML Output (CWE-79) ---
		{
			ID:            "go.template.html",
			Category:      taint.SnkHTMLOutput,
			Language:      rules.LangGo,
			Pattern:       `template\.HTML\(`,
			ObjectType:    "",
			MethodName:    "HTML",
			DangerousArgs: []int{0},
			Severity:      rules.High,
			Description:   "Unescaped HTML template output with potentially tainted data",
			CWEID:         "CWE-79",
			OWASPCategory: "A03:2021-Injection",
		},
		{
			ID:            "go.fmt.fprintf.response",
			Category:      taint.SnkHTMLOutput,
			Language:      rules.LangGo,
			Pattern:       `fmt\.Fprintf\(\s*w\b`,
			ObjectType:    "",
			MethodName:    "Fprintf",
			DangerousArgs: []int{1},
			Severity:      rules.Medium,
			Description:   "Formatted write to HTTP response with potentially tainted data",
			CWEID:         "CWE-79",
			OWASPCategory: "A03:2021-Injection",
		},
		{
			ID:            "go.responsewriter.write",
			Category:      taint.SnkHTMLOutput,
			Language:      rules.LangGo,
			Pattern:       `w\.Write\(`,
			ObjectType:    "http.ResponseWriter",
			MethodName:    "Write",
			DangerousArgs: []int{0},
			Severity:      rules.Medium,
			Description:   "Direct write to HTTP response with potentially tainted data",
			CWEID:         "CWE-79",
			OWASPCategory: "A03:2021-Injection",
		},
		{
			ID:            "go.fmt.fprint.response",
			Category:      taint.SnkHTMLOutput,
			Language:      rules.LangGo,
			Pattern:       `fmt\.Fprint\(\s*w\b`,
			ObjectType:    "",
			MethodName:    "Fprint",
			DangerousArgs: []int{1},
			Severity:      rules.Medium,
			Description:   "Unformatted write to HTTP response with potentially tainted data",
			CWEID:         "CWE-79",
			OWASPCategory: "A03:2021-Injection",
		},
		{
			ID:            "go.fmt.fprintln.response",
			Category:      taint.SnkHTMLOutput,
			Language:      rules.LangGo,
			Pattern:       `fmt\.Fprintln\(\s*w\b`,
			ObjectType:    "",
			MethodName:    "Fprintln",
			DangerousArgs: []int{1},
			Severity:      rules.Medium,
			Description:   "Line write to HTTP response with potentially tainted data",
			CWEID:         "CWE-79",
			OWASPCategory: "A03:2021-Injection",
		},

		// --- SSRF (CWE-918) ---
		{
			ID:            "go.http.get",
			Category:      taint.SnkURLFetch,
			Language:      rules.LangGo,
			Pattern:       `http\.Get\(`,
			ObjectType:    "",
			MethodName:    "Get",
			DangerousArgs: []int{0},
			Severity:      rules.High,
			Description:   "HTTP GET with potentially tainted URL (SSRF)",
			CWEID:         "CWE-918",
			OWASPCategory: "A10:2021-Server-Side Request Forgery",
		},
		{
			ID:            "go.http.newrequest",
			Category:      taint.SnkURLFetch,
			Language:      rules.LangGo,
			Pattern:       `http\.NewRequest\(`,
			ObjectType:    "",
			MethodName:    "NewRequest",
			DangerousArgs: []int{1},
			Severity:      rules.High,
			Description:   "HTTP request construction with potentially tainted URL (SSRF)",
			CWEID:         "CWE-918",
			OWASPCategory: "A10:2021-Server-Side Request Forgery",
		},

		// --- LDAP Injection (CWE-90) ---
		{
			ID:            "go.ldap.search",
			Category:      taint.SnkLDAP,
			Language:      rules.LangGo,
			Pattern:       `\.Search\(`,
			ObjectType:    "*ldap.Conn",
			MethodName:    "Search",
			DangerousArgs: []int{0},
			Severity:      rules.High,
			Description:   "LDAP search with potentially tainted filter",
			CWEID:         "CWE-90",
			OWASPCategory: "A03:2021-Injection",
		},

		// --- Log Injection (CWE-117) ---
		{
			ID:            "go.log.printf",
			Category:      taint.SnkLog,
			Language:      rules.LangGo,
			Pattern:       `log\.Printf\(`,
			ObjectType:    "",
			MethodName:    "Printf",
			DangerousArgs: []int{-1},
			Severity:      rules.Medium,
			Description:   "Log output with potentially tainted data (log injection)",
			CWEID:         "CWE-117",
			OWASPCategory: "A09:2021-Security Logging and Monitoring Failures",
		},
		{
			ID:            "go.log.println",
			Category:      taint.SnkLog,
			Language:      rules.LangGo,
			Pattern:       `log\.Println\(`,
			ObjectType:    "",
			MethodName:    "Println",
			DangerousArgs: []int{-1},
			Severity:      rules.Medium,
			Description:   "Log output with potentially tainted data (log injection)",
			CWEID:         "CWE-117",
			OWASPCategory: "A09:2021-Security Logging and Monitoring Failures",
		},
		{
			ID:            "go.log.print",
			Category:      taint.SnkLog,
			Language:      rules.LangGo,
			Pattern:       `log\.Print\(`,
			ObjectType:    "",
			MethodName:    "Print",
			DangerousArgs: []int{-1},
			Severity:      rules.Medium,
			Description:   "Log output with potentially tainted data (log injection)",
			CWEID:         "CWE-117",
			OWASPCategory: "A09:2021-Security Logging and Monitoring Failures",
		},
		{
			ID:            "go.log.fatalf",
			Category:      taint.SnkLog,
			Language:      rules.LangGo,
			Pattern:       `log\.Fatalf\(`,
			ObjectType:    "",
			MethodName:    "Fatalf",
			DangerousArgs: []int{-1},
			Severity:      rules.Medium,
			Description:   "Fatal log with potentially tainted data (log injection)",
			CWEID:         "CWE-117",
			OWASPCategory: "A09:2021-Security Logging and Monitoring Failures",
		},
		{
			ID:            "go.slog.info",
			Category:      taint.SnkLog,
			Language:      rules.LangGo,
			Pattern:       `slog\.Info\(`,
			ObjectType:    "",
			MethodName:    "slog.Info",
			DangerousArgs: []int{0},
			Severity:      rules.Medium,
			Description:   "Structured log info with potentially tainted data (log injection)",
			CWEID:         "CWE-117",
			OWASPCategory: "A09:2021-Security Logging and Monitoring Failures",
		},
		{
			ID:            "go.slog.warn",
			Category:      taint.SnkLog,
			Language:      rules.LangGo,
			Pattern:       `slog\.Warn\(`,
			ObjectType:    "",
			MethodName:    "slog.Warn",
			DangerousArgs: []int{0},
			Severity:      rules.Medium,
			Description:   "Structured log warn with potentially tainted data (log injection)",
			CWEID:         "CWE-117",
			OWASPCategory: "A09:2021-Security Logging and Monitoring Failures",
		},
		{
			ID:            "go.slog.error",
			Category:      taint.SnkLog,
			Language:      rules.LangGo,
			Pattern:       `slog\.Error\(`,
			ObjectType:    "",
			MethodName:    "slog.Error",
			DangerousArgs: []int{0},
			Severity:      rules.Medium,
			Description:   "Structured log error with potentially tainted data (log injection)",
			CWEID:         "CWE-117",
			OWASPCategory: "A09:2021-Security Logging and Monitoring Failures",
		},
		{
			ID:            "go.slog.debug",
			Category:      taint.SnkLog,
			Language:      rules.LangGo,
			Pattern:       `slog\.Debug\(`,
			ObjectType:    "",
			MethodName:    "slog.Debug",
			DangerousArgs: []int{0},
			Severity:      rules.Medium,
			Description:   "Structured log debug with potentially tainted data (log injection)",
			CWEID:         "CWE-117",
			OWASPCategory: "A09:2021-Security Logging and Monitoring Failures",
		},
		{
			ID:            "go.zap.info",
			Category:      taint.SnkLog,
			Language:      rules.LangGo,
			Pattern:       `(?:zap|logger|sugar)\.Info\(`,
			ObjectType:    "*zap.Logger",
			MethodName:    "Info",
			DangerousArgs: []int{0},
			Severity:      rules.Medium,
			Description:   "Zap logger info with potentially tainted data (log injection)",
			CWEID:         "CWE-117",
			OWASPCategory: "A09:2021-Security Logging and Monitoring Failures",
		},
		{
			ID:            "go.zap.error",
			Category:      taint.SnkLog,
			Language:      rules.LangGo,
			Pattern:       `(?:zap|logger|sugar)\.Error\(`,
			ObjectType:    "*zap.Logger",
			MethodName:    "Error",
			DangerousArgs: []int{0},
			Severity:      rules.Medium,
			Description:   "Zap logger error with potentially tainted data (log injection)",
			CWEID:         "CWE-117",
			OWASPCategory: "A09:2021-Security Logging and Monitoring Failures",
		},
		{
			ID:            "go.logrus.info",
			Category:      taint.SnkLog,
			Language:      rules.LangGo,
			Pattern:       `logrus\.(?:Info|Warn|Error|Debug|Fatal|Panic)(?:f|ln)?\(`,
			ObjectType:    "logrus",
			MethodName:    "logrus.*",
			DangerousArgs: []int{-1},
			Severity:      rules.Medium,
			Description:   "Logrus logger with potentially tainted data (log injection)",
			CWEID:         "CWE-117",
			OWASPCategory: "A09:2021-Security Logging and Monitoring Failures",
		},

		// --- GORM SQL Injection (CWE-89) ---
		{
			ID:            "go.gorm.raw",
			Category:      taint.SnkSQLQuery,
			Language:      rules.LangGo,
			Pattern:       `\.Raw\(`,
			ObjectType:    "*gorm.DB",
			MethodName:    "Raw",
			DangerousArgs: []int{0},
			Severity:      rules.Critical,
			Description:   "GORM raw SQL query with potentially tainted input",
			CWEID:         "CWE-89",
			OWASPCategory: "A03:2021-Injection",
		},
		{
			ID:            "go.gorm.exec",
			Category:      taint.SnkSQLQuery,
			Language:      rules.LangGo,
			Pattern:       `\.Exec\(`,
			ObjectType:    "*gorm.DB",
			MethodName:    "Exec",
			DangerousArgs: []int{0},
			Severity:      rules.Critical,
			Description:   "GORM exec with potentially tainted SQL string",
			CWEID:         "CWE-89",
			OWASPCategory: "A03:2021-Injection",
		},
		{
			ID:            "go.gorm.where.string",
			Category:      taint.SnkSQLQuery,
			Language:      rules.LangGo,
			Pattern:       `\.Where\(`,
			ObjectType:    "*gorm.DB",
			MethodName:    "Where",
			DangerousArgs: []int{0},
			Severity:      rules.High,
			Description:   "GORM Where with potentially tainted string condition",
			CWEID:         "CWE-89",
			OWASPCategory: "A03:2021-Injection",
		},

		// --- text/template XSS (CWE-79) ---
		{
			ID:            "go.text.template.execute",
			Category:      taint.SnkTemplate,
			Language:      rules.LangGo,
			Pattern:       `text/template.*\.Execute\(|tmpl\.Execute\(`,
			ObjectType:    "*text/template.Template",
			MethodName:    "Execute",
			DangerousArgs: []int{1},
			Severity:      rules.High,
			Description:   "text/template execution without auto-escaping (use html/template instead)",
			CWEID:         "CWE-79",
			OWASPCategory: "A03:2021-Injection",
		},

		// --- Weak Cryptographic Hash (CWE-328) ---
		{
			ID:            "go.crypto.md5",
			Category:      taint.SnkCrypto,
			Language:      rules.LangGo,
			Pattern:       `md5\.New\(|md5\.Sum\(`,
			ObjectType:    "",
			MethodName:    "md5.New/md5.Sum",
			DangerousArgs: []int{0},
			Severity:      rules.Medium,
			Description:   "MD5 hash usage (weak, vulnerable to collision attacks)",
			CWEID:         "CWE-328",
			OWASPCategory: "A02:2021-Cryptographic Failures",
		},
		{
			ID:            "go.crypto.sha1",
			Category:      taint.SnkCrypto,
			Language:      rules.LangGo,
			Pattern:       `sha1\.New\(|sha1\.Sum\(`,
			ObjectType:    "",
			MethodName:    "sha1.New/sha1.Sum",
			DangerousArgs: []int{0},
			Severity:      rules.Medium,
			Description:   "SHA1 hash usage (weak, vulnerable to collision attacks)",
			CWEID:         "CWE-328",
			OWASPCategory: "A02:2021-Cryptographic Failures",
		},
		{
			ID:            "go.crypto.des",
			Category:      taint.SnkCrypto,
			Language:      rules.LangGo,
			Pattern:       `des\.NewCipher\(|des\.NewTripleDESCipher\(`,
			ObjectType:    "",
			MethodName:    "des.NewCipher/NewTripleDESCipher",
			DangerousArgs: []int{0},
			Severity:      rules.High,
			Description:   "DES/3DES cipher usage (weak, use AES instead)",
			CWEID:         "CWE-327",
			OWASPCategory: "A02:2021-Cryptographic Failures",
		},
		{
			ID:            "go.crypto.rc4",
			Category:      taint.SnkCrypto,
			Language:      rules.LangGo,
			Pattern:       `rc4\.NewCipher\(`,
			ObjectType:    "",
			MethodName:    "rc4.NewCipher",
			DangerousArgs: []int{0},
			Severity:      rules.High,
			Description:   "RC4 stream cipher usage (broken, use AES-GCM instead)",
			CWEID:         "CWE-327",
			OWASPCategory: "A02:2021-Cryptographic Failures",
		},

		// --- Insecure Random (CWE-338) ---
		{
			ID:            "go.crypto.math_rand",
			Category:      taint.SnkCrypto,
			Language:      rules.LangGo,
			Pattern:       `math/rand|rand\.Intn\(|rand\.Int\(|rand\.Read\(`,
			ObjectType:    "",
			MethodName:    "math/rand",
			DangerousArgs: []int{-1},
			Severity:      rules.High,
			Description:   "math/rand used for security-sensitive value (use crypto/rand instead)",
			CWEID:         "CWE-338",
			OWASPCategory: "A02:2021-Cryptographic Failures",
		},

		// --- Hardcoded Crypto Key (CWE-321) ---
		{
			ID:            "go.crypto.hardcoded_key",
			Category:      taint.SnkCrypto,
			Language:      rules.LangGo,
			Pattern:       `aes\.NewCipher\(\s*\[\]byte\s*\(`,
			ObjectType:    "",
			MethodName:    "aes.NewCipher with literal key",
			DangerousArgs: []int{0},
			Severity:      rules.Critical,
			Description:   "AES cipher initialized with potentially hardcoded key",
			CWEID:         "CWE-321",
			OWASPCategory: "A02:2021-Cryptographic Failures",
		},

		// --- ECB Mode Cipher (CWE-327) ---
		{
			ID:            "go.crypto.ecb_mode",
			Category:      taint.SnkCrypto,
			Language:      rules.LangGo,
			Pattern:       `cipher\.NewECBEncrypter\(|cipher\.NewECBDecrypter\(|\.Encrypt\(\s*dst\s*,\s*src\s*\)`,
			ObjectType:    "",
			MethodName:    "ECB mode encryption",
			DangerousArgs: []int{-1},
			Severity:      rules.High,
			Description:   "ECB mode cipher usage (no diffusion, use CBC/GCM instead)",
			CWEID:         "CWE-327",
			OWASPCategory: "A02:2021-Cryptographic Failures",
		},

		// --- Email Header Injection (CWE-93) ---
		{
			ID:            "go.net.smtp.sendmail",
			Category:      taint.SnkHeader,
			Language:      rules.LangGo,
			Pattern:       `smtp\.SendMail\(`,
			ObjectType:    "",
			MethodName:    "SendMail",
			DangerousArgs: []int{2, 3, 4},
			Severity:      rules.High,
			Description:   "SMTP send with potentially tainted headers/recipients (email injection)",
			CWEID:         "CWE-93",
			OWASPCategory: "A03:2021-Injection",
		},

		// --- Deserialization (CWE-502) ---
		{
			ID:            "go.json.decoder.decode",
			Category:      taint.SnkDeserialize,
			Language:      rules.LangGo,
			Pattern:       `\.Decode\(`,
			ObjectType:    "*json.Decoder",
			MethodName:    "Decode",
			DangerousArgs: []int{0},
			Severity:      rules.Medium,
			Description:   "JSON decode into struct from untrusted source",
			CWEID:         "CWE-502",
			OWASPCategory: "A08:2021-Software and Data Integrity Failures",
		},

		// --- Redis Command Injection (CWE-77) ---
		{
			ID:            "go.redis.do",
			Category:      taint.SnkCommand,
			Language:      rules.LangGo,
			Pattern:       `\.Do\(\s*ctx\s*,|rdb\.Do\(`,
			ObjectType:    "*redis.Client",
			MethodName:    "Do",
			DangerousArgs: []int{1},
			Severity:      rules.High,
			Description:   "Redis command execution with potentially tainted arguments",
			CWEID:         "CWE-77",
			OWASPCategory: "A03:2021-Injection",
		},
		{
			ID:            "go.redis.eval",
			Category:      taint.SnkEval,
			Language:      rules.LangGo,
			Pattern:       `\.Eval\(\s*ctx\s*,|\.EvalSha\(`,
			ObjectType:    "*redis.Client",
			MethodName:    "Eval",
			DangerousArgs: []int{1},
			Severity:      rules.Critical,
			Description:   "Redis Lua script evaluation with potentially tainted script",
			CWEID:         "CWE-94",
			OWASPCategory: "A03:2021-Injection",
		},

		// --- DNS Lookup with Tainted Hostname (CWE-918) ---
		{
			ID:            "go.net.lookup",
			Category:      taint.SnkURLFetch,
			Language:      rules.LangGo,
			Pattern:       `net\.LookupHost\(|net\.LookupIP\(|net\.LookupAddr\(`,
			ObjectType:    "",
			MethodName:    "LookupHost/LookupIP",
			DangerousArgs: []int{0},
			Severity:      rules.High,
			Description:   "DNS lookup with potentially tainted hostname (SSRF/DNS rebinding)",
			CWEID:         "CWE-918",
			OWASPCategory: "A10:2021-Server-Side Request Forgery",
		},

		// --- Docker Exec (CWE-78) ---
		{
			ID:            "go.docker.containerexec",
			Category:      taint.SnkCommand,
			Language:      rules.LangGo,
			Pattern:       `\.ContainerExecCreate\(|\.ContainerExecStart\(`,
			ObjectType:    "docker.Client",
			MethodName:    "ContainerExecCreate",
			DangerousArgs: []int{1},
			Severity:      rules.Critical,
			Description:   "Docker container exec with potentially tainted command",
			CWEID:         "CWE-78",
			OWASPCategory: "A03:2021-Injection",
		},

		// --- Kafka Message Construction (CWE-77) ---
		{
			ID:            "go.kafka.produce",
			Category:      taint.SnkCommand,
			Language:      rules.LangGo,
			Pattern:       `\.Produce\(|writer\.WriteMessages\(`,
			ObjectType:    "kafka.Writer",
			MethodName:    "Produce/WriteMessages",
			DangerousArgs: []int{0},
			Severity:      rules.Medium,
			Description:   "Kafka message produced with potentially tainted data",
			CWEID:         "CWE-77",
			OWASPCategory: "A03:2021-Injection",
		},

		// --- XPath Injection (CWE-643) ---
		{
			ID:            "go.xmlpath.compile",
			Category:      taint.SnkXPath,
			Language:      rules.LangGo,
			Pattern:       `xmlpath\.Compile\s*\(|xmlpath\.MustCompile\s*\(`,
			ObjectType:    "xmlpath",
			MethodName:    "Compile/MustCompile",
			DangerousArgs: []int{0},
			Severity:      rules.High,
			Description:   "XPath compilation with tainted expression",
			CWEID:         "CWE-643",
			OWASPCategory: "A03:2021-Injection",
		},
		{
			ID:            "go.antchfx.xpath.compile",
			Category:      taint.SnkXPath,
			Language:      rules.LangGo,
			Pattern:       `xpath\.Compile\s*\(|xpath\.MustCompile\s*\(`,
			ObjectType:    "antchfx/xpath",
			MethodName:    "Compile/MustCompile",
			DangerousArgs: []int{0},
			Severity:      rules.High,
			Description:   "antchfx/xpath compilation with tainted expression",
			CWEID:         "CWE-643",
			OWASPCategory: "A03:2021-Injection",
		},
		{
			ID:            "go.htmlquery.find",
			Category:      taint.SnkXPath,
			Language:      rules.LangGo,
			Pattern:       `htmlquery\.Find\s*\(|htmlquery\.FindOne\s*\(`,
			ObjectType:    "htmlquery",
			MethodName:    "Find/FindOne",
			DangerousArgs: []int{1},
			Severity:      rules.High,
			Description:   "htmlquery XPath find with tainted expression",
			CWEID:         "CWE-643",
			OWASPCategory: "A03:2021-Injection",
		},

		// --- Template Injection (CWE-1336) ---
		{
			ID:            "go.pongo2.fromstring",
			Category:      taint.SnkTemplate,
			Language:      rules.LangGo,
			Pattern:       `pongo2\.FromString\s*\(|pongo2\.Must\s*\(`,
			ObjectType:    "pongo2",
			MethodName:    "FromString/Must",
			DangerousArgs: []int{0},
			Severity:      rules.High,
			Description:   "pongo2 template from tainted string",
			CWEID:         "CWE-1336",
			OWASPCategory: "A03:2021-Injection",
		},
		{
			ID:            "go.jet.template.parse",
			Category:      taint.SnkTemplate,
			Language:      rules.LangGo,
			Pattern:       `jet\.NewSet\s*\(.*\.Parse\s*\(`,
			ObjectType:    "jet",
			MethodName:    "NewSet.Parse",
			DangerousArgs: []int{0},
			Severity:      rules.High,
			Description:   "Jet template parse from tainted string",
			CWEID:         "CWE-1336",
			OWASPCategory: "A03:2021-Injection",
		},

		// --- Additional SSRF (CWE-918) ---
		{
			ID:            "go.http.post",
			Category:      taint.SnkURLFetch,
			Language:      rules.LangGo,
			Pattern:       `http\.Post\s*\(`,
			ObjectType:    "",
			MethodName:    "Post",
			DangerousArgs: []int{0},
			Severity:      rules.High,
			Description:   "HTTP POST with tainted URL (SSRF)",
			CWEID:         "CWE-918",
			OWASPCategory: "A10:2021-Server-Side Request Forgery",
		},
		{
			ID:            "go.http.postform",
			Category:      taint.SnkURLFetch,
			Language:      rules.LangGo,
			Pattern:       `http\.PostForm\s*\(`,
			ObjectType:    "",
			MethodName:    "PostForm",
			DangerousArgs: []int{0},
			Severity:      rules.High,
			Description:   "HTTP PostForm with tainted URL (SSRF)",
			CWEID:         "CWE-918",
			OWASPCategory: "A10:2021-Server-Side Request Forgery",
		},
		{
			ID:            "go.http.newrequestwithcontext",
			Category:      taint.SnkURLFetch,
			Language:      rules.LangGo,
			Pattern:       `http\.NewRequestWithContext\s*\(`,
			ObjectType:    "",
			MethodName:    "NewRequestWithContext",
			DangerousArgs: []int{2},
			Severity:      rules.High,
			Description:   "HTTP request with context and tainted URL (SSRF)",
			CWEID:         "CWE-918",
			OWASPCategory: "A10:2021-Server-Side Request Forgery",
		},

		// --- HTTP Header Injection (CWE-113) ---
		{
			ID:            "go.http.header.set",
			Category:      taint.SnkHeader,
			Language:      rules.LangGo,
			Pattern:       `w\.Header\(\)\.Set\s*\(`,
			ObjectType:    "http.ResponseWriter",
			MethodName:    "Header.Set",
			DangerousArgs: []int{1},
			Severity:      rules.Medium,
			Description:   "HTTP response header with tainted value",
			CWEID:         "CWE-113",
			OWASPCategory: "A03:2021-Injection",
		},
		{
			ID:            "go.http.header.add",
			Category:      taint.SnkHeader,
			Language:      rules.LangGo,
			Pattern:       `w\.Header\(\)\.Add\s*\(`,
			ObjectType:    "http.ResponseWriter",
			MethodName:    "Header.Add",
			DangerousArgs: []int{1},
			Severity:      rules.Medium,
			Description:   "HTTP response header add with tainted value",
			CWEID:         "CWE-113",
			OWASPCategory: "A03:2021-Injection",
		},

		// --- Framework HTML Output (CWE-79) ---
		{
			ID:            "go.gin.html",
			Category:      taint.SnkHTMLOutput,
			Language:      rules.LangGo,
			Pattern:       `c\.HTML\s*\(`,
			ObjectType:    "*gin.Context",
			MethodName:    "HTML",
			DangerousArgs: []int{2},
			Severity:      rules.Medium,
			Description:   "Gin HTML template response with tainted data",
			CWEID:         "CWE-79",
			OWASPCategory: "A03:2021-Injection",
		},
		{
			ID:            "go.echo.html",
			Category:      taint.SnkHTMLOutput,
			Language:      rules.LangGo,
			Pattern:       `c\.HTML\s*\(`,
			ObjectType:    "echo.Context",
			MethodName:    "HTML",
			DangerousArgs: []int{1},
			Severity:      rules.Medium,
			Description:   "Echo HTML response with tainted data",
			CWEID:         "CWE-79",
			OWASPCategory: "A03:2021-Injection",
		},
	}
}
