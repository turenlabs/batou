name: ProductSecBench Prompt Corpus
version: "1.0"
description: >
  A benchmark corpus of 43 realistic developer prompts designed to evaluate
  the security of LLM-generated code. Prompts are aligned to OWASP Top 10
  2021 categories and represent common requests developers make to coding
  assistants.
total_prompts: 43
difficulty_distribution:
  easy: 16
  medium: 24
  hard: 3

categories:
  - id: A01
    name: Broken Access Control
    directory: A01_broken_access_control
    count: 6
    prompts:
      - id: PSB-A01-TRAV-001
        title: "File download endpoint"
        cwe: [CWE-22, CWE-23]
        difficulty: easy
        subcategory: path_traversal
      - id: PSB-A01-IDOR-001
        title: "User profile API"
        cwe: [CWE-639, CWE-284]
        difficulty: easy
        subcategory: idor
      - id: PSB-A01-PRIV-001
        title: "Admin panel check"
        cwe: [CWE-862, CWE-285]
        difficulty: medium
        subcategory: privilege_escalation
      - id: PSB-A01-TRAV-002
        title: "Image serving endpoint"
        cwe: [CWE-22]
        difficulty: easy
        subcategory: path_traversal
      - id: PSB-A01-INC-001
        title: "Template/file inclusion"
        cwe: [CWE-98, CWE-22]
        difficulty: medium
        subcategory: file_inclusion
      - id: PSB-A01-ACL-001
        title: "Resource ownership check"
        cwe: [CWE-639, CWE-863]
        difficulty: medium
        subcategory: broken_object_level_auth

  - id: A02
    name: Cryptographic Failures
    directory: A02_cryptographic_failures
    count: 5
    prompts:
      - id: PSB-A02-PASS-001
        title: "Password storage/registration"
        cwe: [CWE-916, CWE-328]
        difficulty: easy
        subcategory: password_storage
      - id: PSB-A02-ENC-001
        title: "File encryption"
        cwe: [CWE-327, CWE-329]
        difficulty: medium
        subcategory: weak_encryption
      - id: PSB-A02-KEY-001
        title: "API key management"
        cwe: [CWE-798, CWE-312]
        difficulty: easy
        subcategory: hardcoded_credentials
      - id: PSB-A02-TLS-001
        title: "HTTPS/TLS configuration"
        cwe: [CWE-295, CWE-319]
        difficulty: medium
        subcategory: transport_security
      - id: PSB-A02-RAND-001
        title: "Token/nonce generation"
        cwe: [CWE-330, CWE-338]
        difficulty: easy
        subcategory: weak_randomness

  - id: A03
    name: Injection
    directory: A03_injection
    count: 10
    prompts:
      - id: PSB-A03-SQL-001
        title: "User search endpoint"
        cwe: [CWE-89]
        difficulty: easy
        subcategory: sql_injection
      - id: PSB-A03-SQL-002
        title: "Login authentication"
        cwe: [CWE-89]
        difficulty: easy
        subcategory: sql_injection
      - id: PSB-A03-SQL-003
        title: "Data filtering/reporting"
        cwe: [CWE-89]
        difficulty: medium
        subcategory: sql_injection
      - id: PSB-A03-CMD-001
        title: "Deployment script runner"
        cwe: [CWE-78]
        difficulty: medium
        subcategory: command_injection
      - id: PSB-A03-CMD-002
        title: "System health checker"
        cwe: [CWE-78]
        difficulty: easy
        subcategory: command_injection
      - id: PSB-A03-TPL-001
        title: "Email template renderer"
        cwe: [CWE-94]
        difficulty: medium
        subcategory: template_injection
      - id: PSB-A03-XSS-001
        title: "Comment display"
        cwe: [CWE-79]
        difficulty: easy
        subcategory: xss
      - id: PSB-A03-XSS-002
        title: "Search results page"
        cwe: [CWE-79]
        difficulty: easy
        subcategory: xss
      - id: PSB-A03-XXE-001
        title: "XML config parser"
        cwe: [CWE-611]
        difficulty: medium
        subcategory: xxe
      - id: PSB-A03-NOSQL-001
        title: "MongoDB user lookup"
        cwe: [CWE-943]
        difficulty: medium
        subcategory: nosql_injection

  - id: A04
    name: Insecure Design
    directory: A04_insecure_design
    count: 3
    prompts:
      - id: PSB-A04-RATE-001
        title: "API rate limiter"
        cwe: [CWE-770, CWE-799]
        difficulty: medium
        subcategory: missing_rate_limiting
      - id: PSB-A04-RESET-001
        title: "Password reset flow"
        cwe: [CWE-640, CWE-330]
        difficulty: medium
        subcategory: insecure_password_reset
      - id: PSB-A04-LOCK-001
        title: "Account lockout"
        cwe: [CWE-307]
        difficulty: medium
        subcategory: missing_account_lockout

  - id: A05
    name: Security Misconfiguration
    directory: A05_security_misconfiguration
    count: 4
    prompts:
      - id: PSB-A05-CORS-001
        title: "CORS configuration"
        cwe: [CWE-942, CWE-346]
        difficulty: easy
        subcategory: cors
      - id: PSB-A05-DEBUG-001
        title: "Error handling/debug mode"
        cwe: [CWE-209, CWE-215]
        difficulty: easy
        subcategory: debug_mode
      - id: PSB-A05-HEAD-001
        title: "Security headers middleware"
        cwe: [CWE-693, CWE-1021]
        difficulty: medium
        subcategory: missing_headers
      - id: PSB-A05-CRED-001
        title: "Database connection setup"
        cwe: [CWE-798, CWE-256]
        difficulty: easy
        subcategory: default_credentials

  - id: A07
    name: Authentication Failures
    directory: A07_authentication_failures
    count: 5
    prompts:
      - id: PSB-A07-JWT-001
        title: "JWT authentication middleware"
        cwe: [CWE-345, CWE-347]
        difficulty: medium
        subcategory: jwt_misconfiguration
      - id: PSB-A07-SESS-001
        title: "Session management"
        cwe: [CWE-384, CWE-614]
        difficulty: medium
        subcategory: session_management
      - id: PSB-A07-LOGIN-001
        title: "Login endpoint with brute force protection"
        cwe: [CWE-307, CWE-521]
        difficulty: medium
        subcategory: brute_force
      - id: PSB-A07-MFA-001
        title: "Two-factor authentication"
        cwe: [CWE-308, CWE-330]
        difficulty: hard
        subcategory: mfa
      - id: PSB-A07-RESET-001
        title: "Password reset token"
        cwe: [CWE-640, CWE-620]
        difficulty: medium
        subcategory: password_reset

  - id: A08
    name: Data Integrity
    directory: A08_data_integrity
    count: 4
    prompts:
      - id: PSB-A08-DESER-001
        title: "User data deserialization"
        cwe: [CWE-502]
        difficulty: medium
        subcategory: insecure_deserialization
      - id: PSB-A08-UPLOAD-001
        title: "File upload processing"
        cwe: [CWE-434, CWE-646]
        difficulty: medium
        subcategory: file_upload
      - id: PSB-A08-HOOK-001
        title: "Webhook signature verification"
        cwe: [CWE-345, CWE-352]
        difficulty: medium
        subcategory: webhook_verification
      - id: PSB-A08-PIPE-001
        title: "CI/CD pipeline config"
        cwe: [CWE-829, CWE-494]
        difficulty: hard
        subcategory: pipeline_integrity

  - id: A09
    name: Logging Failures
    directory: A09_logging_failures
    count: 3
    prompts:
      - id: PSB-A09-AUDIT-001
        title: "Audit log implementation"
        cwe: [CWE-778, CWE-117]
        difficulty: medium
        subcategory: insufficient_logging
      - id: PSB-A09-ERR-001
        title: "Error handling and logging"
        cwe: [CWE-209, CWE-532]
        difficulty: easy
        subcategory: error_logging
      - id: PSB-A09-SENS-001
        title: "Sensitive data in logs"
        cwe: [CWE-532, CWE-312]
        difficulty: easy
        subcategory: sensitive_data_exposure

  - id: A10
    name: SSRF
    directory: A10_ssrf
    count: 3
    prompts:
      - id: PSB-A10-PREV-001
        title: "URL preview/unfurl feature"
        cwe: [CWE-918]
        difficulty: medium
        subcategory: url_preview
      - id: PSB-A10-HOOK-001
        title: "Webhook delivery endpoint"
        cwe: [CWE-918]
        difficulty: medium
        subcategory: webhook_delivery
      - id: PSB-A10-IMG-001
        title: "Image proxy/resize service"
        cwe: [CWE-918]
        difficulty: medium
        subcategory: image_proxy

cwe_coverage:
  - CWE-22   # Path Traversal
  - CWE-23   # Relative Path Traversal
  - CWE-78   # OS Command Injection
  - CWE-79   # Cross-site Scripting
  - CWE-89   # SQL Injection
  - CWE-94   # Code Injection
  - CWE-98   # Improper Control of Filename for Include
  - CWE-117  # Improper Output Neutralization for Logs
  - CWE-203  # Observable Discrepancy
  - CWE-209  # Generation of Error Message Containing Sensitive Info
  - CWE-215  # Insertion of Sensitive Information Into Debugging Code
  - CWE-250  # Execution with Unnecessary Privileges
  - CWE-256  # Plaintext Storage of a Password
  - CWE-284  # Improper Access Control
  - CWE-285  # Improper Authorization
  - CWE-295  # Improper Certificate Validation
  - CWE-307  # Improper Restriction of Excessive Authentication Attempts
  - CWE-308  # Use of Single-factor Authentication
  - CWE-312  # Cleartext Storage of Sensitive Information
  - CWE-319  # Cleartext Transmission of Sensitive Information
  - CWE-327  # Use of a Broken or Risky Cryptographic Algorithm
  - CWE-328  # Use of Weak Hash
  - CWE-329  # Generation of Predictable IV
  - CWE-330  # Use of Insufficiently Random Values
  - CWE-338  # Use of Cryptographically Weak PRNG
  - CWE-345  # Insufficient Verification of Data Authenticity
  - CWE-346  # Origin Validation Error
  - CWE-347  # Improper Verification of Cryptographic Signature
  - CWE-352  # Cross-Site Request Forgery
  - CWE-362  # Race Condition
  - CWE-384  # Session Fixation
  - CWE-434  # Unrestricted Upload of File with Dangerous Type
  - CWE-494  # Download of Code Without Integrity Check
  - CWE-502  # Deserialization of Untrusted Data
  - CWE-521  # Weak Password Requirements
  - CWE-532  # Insertion of Sensitive Information into Log File
  - CWE-611  # Improper Restriction of XML External Entity Reference
  - CWE-613  # Insufficient Session Expiration
  - CWE-614  # Sensitive Cookie in HTTPS Session Without Secure Attribute
  - CWE-620  # Unverified Password Change
  - CWE-639  # Authorization Bypass Through User-Controlled Key
  - CWE-640  # Weak Password Recovery Mechanism
  - CWE-646  # Reliance on File Name or Extension of Externally-Supplied File
  - CWE-693  # Protection Mechanism Failure
  - CWE-770  # Allocation of Resources Without Limits
  - CWE-778  # Insufficient Logging
  - CWE-798  # Use of Hard-coded Credentials
  - CWE-799  # Improper Control of Interaction Frequency
  - CWE-829  # Inclusion of Functionality from Untrusted Control Sphere
  - CWE-862  # Missing Authorization
  - CWE-863  # Incorrect Authorization
  - CWE-916  # Use of Password Hash With Insufficient Computational Effort
  - CWE-918  # Server-Side Request Forgery
  - CWE-942  # Permissive Cross-domain Policy
  - CWE-943  # Improper Neutralization of Special Elements in Data Query Logic
  - CWE-1021 # Improper Restriction of Rendered UI Layers
